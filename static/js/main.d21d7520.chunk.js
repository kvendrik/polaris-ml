(this["webpackJsonppolaris-whiteboarder"]=this["webpackJsonppolaris-whiteboarder"]||[]).push([[0],{103:function(e,t,a){e.exports=a(246)},114:function(e,t){},115:function(e,t){},116:function(e,t){},117:function(e,t){},118:function(e,t){},119:function(e,t){},245:function(e,t,a){},246:function(e,t,a){"use strict";a.r(t);var n=a(13),r=a.n(n),c=a(19),s=a(0),o=a.n(s),i=a(27),l=a.n(i),u=a(101),m=a(16);function d(e,t,a){var n,s,o,i,l,d,p,g,b,v,w,y,E,x,k,j,O;return r.a.async((function(S){for(;;)switch(S.prev=S.next){case 0:return n=m.h((function(){return m.a.fromPixels(a).expandDims(0)})),s=Object(c.a)(n.shape,3),s[0],o=s[1],i=s[2],S.next=4,r.a.awrap(e.executeAsync(n));case 4:return l=S.sent,d=Object(c.a)(l,2),p=d[0],g=d[1],b=p.dataSync(),v=g.dataSync(),n.dispose(),m.b(l),w=f(b,p.shape[1],p.shape[2]),y=Object(c.a)(w,2),E=y[0],x=y[1],k=m.c(),m.f("cpu"),j=m.h((function(){return m.d.nonMaxSuppression(m.g(v,[g.shape[1],g.shape[3]]),E,20,.5,.5)})),O=j.dataSync(),j.dispose(),m.f(k),S.abrupt("return",Object(u.a)(O).map((function(e){return{boundingBox:h(e,i,o,v),class:t[Math.round(x[e])],score:E[e]}})));case 18:case"end":return S.stop()}}))}function f(e,t,a){for(var n=[],r=[],c=0;c<t;c++){for(var s=Number.MIN_VALUE,o=-1,i=0;i<a;i++)e[c*a+i]>s&&(s=e[c*a+i],o=i);n[c]=s,r[c]=o}return[n,r]}function h(e,t,a,n){for(var r=[],c=0;c<4;c++)r[c]=n[4*e+c];var s=r[0]*a,o=r[1]*t,i=r[2]*a;return{x:o,y:s,width:r[3]*t-o,height:i-s}}var p=a(14);a(120);var g=function(){var e=Object(s.useState)(""),t=Object(c.a)(e,2),a=t[0],n=t[1],r=Object(s.useCallback)((function(e){return n(e)}),[]);return o.a.createElement(p.c,{sectioned:!0},o.a.createElement(p.g,{label:"Text field",value:a,onChange:r}))};var b=function(){return o.a.createElement(p.c,null,o.a.createElement(p.f,{resourceName:{singular:"customer",plural:"customers"},items:[{id:341,url:"customers/341",name:"Mae Jemison",location:"Decatur, USA"},{id:256,url:"customers/256",name:"Ellen Ochoa",location:"Los Angeles, USA"},{id:214,url:"customers/213",name:"John Divee",location:"Ottawa, Canada"}],renderItem:function(e){var t=e.id,a=e.url,n=e.name,r=e.location,c=o.a.createElement(p.b,{customer:!0,size:"medium",name:n});return o.a.createElement(p.e,{id:t,url:a,media:c,accessibilityLabel:"View details for ".concat(n)},o.a.createElement("h3",null,o.a.createElement(p.h,{variation:"strong"},n)),o.a.createElement("div",null,r))}}))};var v=function(e){var t=e.components,a=t.includes("Page");return o.a.createElement(p.a,null,o.a.createElement(p.d,{title:a?"Page":null,primaryAction:a?{content:"Save"}:null},t.map((function(e,t){switch(e){case"TextField":return o.a.createElement(g,{key:t});case"CustomerList":return o.a.createElement(b,{key:t})}}))))},w=(a(245),function(e){var t,a;return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(m.e("".concat(e,"/model.json")));case 2:return t=n.sent,n.next=5,r.a.awrap(fetch("".concat(e,"/labels.json")).then((function(e){return e.json()})));case 5:return a=n.sent,n.abrupt("return",(function(e){return r.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,r.a.awrap(d(t,a,e));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}))}));case 7:case"end":return n.stop()}}))}("model"));function y(e,t){var a=t.type,n=t.payload,r=e.image;switch(a){case"loading":return r===n.image?e:{loading:!0,image:n.image,results:[],status:"Loading..."};case"success":return{loading:!1,image:r,results:n.results,status:"Upload a wireframe drawing"};case"error":return{loading:!1,image:r,results:[],status:"No components detected. Please try again or check the console for the raw output."}}}function E(e){var t=e.getContext("2d");t.clearRect(0,0,t.canvas.width,t.canvas.height)}function x(e,t){var a=e.getContext("2d");a.clearRect(0,0,a.canvas.width,a.canvas.height);var n="14px Open Sans",r=parseInt(n,10);a.font=n,a.textBaseline="top",a.strokeStyle="#2da15f",a.lineWidth=4,a.fillStyle="#2da15f";var c=!0,s=!1,o=void 0;try{for(var i,l=t[Symbol.iterator]();!(c=(i=l.next()).done);c=!0){var u=i.value,m=u.class,d=u.score,f=u.boundingBox,h=f.x,p=f.y,g=f.width,b=f.height;a.strokeRect(h,p,g,b);var v=a.measureText(L(m,d)).width;a.fillRect(h,p,v+4,r+4)}}catch(A){s=!0,o=A}finally{try{c||null==l.return||l.return()}finally{if(s)throw o}}var w=!0,y=!1,E=void 0;try{for(var x,k=t[Symbol.iterator]();!(w=(x=k.next()).done);w=!0){var j=x.value,O=j.class,S=j.score,C=j.boundingBox,N=C.x,R=C.y;a.fillStyle="#000000",a.fillText(L(O,S),N,R)}}catch(A){y=!0,E=A}finally{try{w||null==k.return||k.return()}finally{if(y)throw E}}function L(e,t){return"".concat(e," (").concat(Math.round(100*t),"%)")}}var k=document.getElementById("root");l.a.render(o.a.createElement((function(){var e=Object(s.useMemo)((function(){return new FileReader}),[]),t=Object(s.useRef)(),a=Object(s.useRef)(),n=Object(s.useRef)(),i=Object(s.useReducer)(y,{loading:!1,image:"",status:"Upload a wireframe drawing",results:[]}),l=Object(c.a)(i,2),u=l[0],m=u.loading,d=u.image,f=u.status,h=u.results,p=l[1],g=Object(s.useMemo)((function(){var e=(window.innerWidth<600?window.innerWidth:600)-48;return{width:e,height:e-100}}),[window.innerWidth]),b=Object(s.useCallback)((function(t){var a=Object(c.a)(t.target.files,1)[0];a&&e.readAsDataURL(a)}),[e]);Object(s.useEffect)((function(){e.addEventListener("load",(function(e){var t=e.target.result;return O(t)})),t.current.addEventListener("load",(function(){var e,a;return r.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return E(n.current),c.next=3,r.a.awrap(w);case 3:return e=c.sent,c.next=6,r.a.awrap(e(t.current));case 6:a=c.sent,console.log(a),a.length>0?(x(n.current,a),p({type:"success",payload:{results:a}})):p({type:"error"});case 9:case"end":return c.stop()}}))}))}),[e,n,t,w]);var k=Object(s.useCallback)((function(){return O("wireframe-example.jpg")}),[]),j=Object(s.useCallback)((function(){m||a.current.click()}),[m]),O=Object(s.useCallback)((function(e){return r.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(!m){t.next=2;break}return t.abrupt("return");case 2:p({type:"loading",payload:{image:e}});case 3:case"end":return t.stop()}}))}),[m]),S=h.map((function(e){return e.class}));return o.a.createElement(o.a.Fragment,null,o.a.createElement("main",{className:"control-board"},o.a.createElement("p",{className:"intro container"},"This ",o.a.createElement("a",{href:"https://github.com/kvendrik/polaris-whiteboarder",target:"_blank",rel:"noopener noreferrer"},"experiment")," creates simple ",o.a.createElement("a",{href:"https://polaris.shopify.com",target:"_blank",rel:"noopener noreferrer"},"Polaris")," prototypes from ",o.a.createElement("a",{href:"https://github.com/kvendrik/polaris-ml/tree/master/training-data",target:"_blank",rel:"noopener noreferrer"},"wireframes drawn on a whiteboard"),"."),o.a.createElement("section",{className:"result-status container"},o.a.createElement("p",null,o.a.createElement("button",{className:"status",onClick:j},f),o.a.createElement("br",null),o.a.createElement("small",null,"Don't feel like drawing? ",o.a.createElement("button",{onClick:k},"View an example"))),o.a.createElement("div",{className:"image-container"},o.a.createElement("canvas",{className:"image-container__canvas",ref:n,width:g.width,height:g.height}),o.a.createElement("img",{src:d,ref:t,alt:"",width:g.width,height:g.height})),o.a.createElement("input",{className:"file-picker",ref:a,type:"file",onChange:b}))),h.length>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement("hr",null),o.a.createElement(v,{components:S})))}),null),k)}},[[103,1,2]]]);
//# sourceMappingURL=main.d21d7520.chunk.js.map